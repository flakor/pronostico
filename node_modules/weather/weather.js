//Archivo "weather.js"


exports.city = function(name) {
  //console.log(name);

  switch(name){
//centro meteologico de iquique
// =============================================================================
      case 'arica':
              var options = {
                  host: 'web.directemar.cl',
                  path: '/met/jturno/PRONOSTICOS/Cenmeteoique/72/arica72.txt'
                  }
              break;
      case 'iquique':
              var options = {
                  host: 'web.directemar.cl',
                  path: '/met/jturno/PRONOSTICOS/Cenmeteoique/72/iquique72.txt'
                }
          break;
      case 'patache':
              var options = {
                  host: 'web.directemar.cl',
                  path: '/met/jturno/PRONOSTICOS/Cenmeteoique/72/patache72.txt'
                }
            break;
      case 'tocopilla':
              var options = {
                  host: 'web.directemar.cl',
                  path: '/met/jturno/PRONOSTICOS/Cenmeteoique/72/tocopilla72.txt'
                }
            break;
      case 'mejillones':
              var options = {
                  host: 'web.directemar.cl',
                  path: '/met/jturno/PRONOSTICOS/Cenmeteoique/72/mejillones72.txt'
                }
            break;
      case 'antofagasta':
              var options = {
                  host: 'web.directemar.cl',
                  path: '/met/jturno/PRONOSTICOS/Cenmeteoique/72/antofagasta72.txt'
                }
            break;
      case 'taltal':
              var options = {
                  host: 'web.directemar.cl',
                  path: '/met/jturno/PRONOSTICOS/Cenmeteoique/72/taltal72.txt'
                }
            break;
//Centro Meteorológico de Valparaíso
// =============================================================================
      case 'pascua':
              var options = {
                  host: 'web.directemar.cl',
                  path:  '/met/jturno/PRONOSTICOS/Cenmeteovalp/72/pascua72.txt'
                }
            break;
      case 'chanaral':
              var options = {
                  host: 'web.directemar.cl',
                  path:  '/met/jturno/PRONOSTICOS/Cenmeteovalp/72/cha%C3%B1aral72.txt'
                }
            break;
      case 'caldera':
              var options = {
                  host: 'web.directemar.cl',
                  path:  '/met/jturno/PRONOSTICOS/Cenmeteovalp/72/caldera72.txt'
                }
            break;
      case 'huasco':
              var options = {
                  host: 'web.directemar.cl',
                  path: '/met/jturno/PRONOSTICOS/Cenmeteovalp/72/huasco72.txt'
                }
            break;
      case 'coquimbo':
              var options = {
                  host: 'web.directemar.cl',
                  path: '/met/jturno/PRONOSTICOS/Cenmeteovalp/72/coquimbo72.txt'
                }
            break;
      case 'losvilos':
              var options = {
                  host: 'web.directemar.cl',
                  path: '/met/jturno/PRONOSTICOS/Cenmeteovalp/72/losvilos72.txt'
                }
            break;
      case 'quintero':
              var options = {
                  host: 'web.directemar.cl',
                  path: '/met/jturno/PRONOSTICOS/Cenmeteovalp/72/quintero72.txt'
                }
            break;
      case 'valpo':
              var options = {
                  host: 'web.directemar.cl',
                  path: '/met/jturno/PRONOSTICOS/Cenmeteovalp/72/valpo72.txt'
                }
            break;
      case 'antonio':
              var options = {
                  host: 'web.directemar.cl',
                  path: '/met/jturno/PRONOSTICOS/Cenmeteovalp/72/antonio72.txt'
                }
            break;
      case 'fernandez':
            var options = {
                host: 'web.directemar.cl',
                path: '/met/jturno/PRONOSTICOS/Cenmeteovalp/72/fernandez72.txt'
              }
          break;
//Centro Meteorológico de Talcahuano
// =============================================================================
      case 'constitucion':
              var options = {
                  host: 'web.directemar.cl',
                  path: '/met/jturno/PRONOSTICOS/Cenmeteotalc/72/constitucion72.txt'
                }
            break;
      case 'lirquen':
              var options = {
                  host: 'web.directemar.cl',
                  path: '/met/jturno/PRONOSTICOS/Cenmeteotalc/72/lirquen72.txt'
                }
            break;
      case 'talcahuano':
              var options = {
                  host: 'web.directemar.cl',
                  path: 'met/jturno/PRONOSTICOS/Cenmeteotalc/72/talcahuano72.txt'
                }
            break;
      case 'vicente':
              var options = {
                  host: 'web.directemar.cl',
                  path: '/met/jturno/PRONOSTICOS/Cenmeteotalc/72/vicente72.txt'
                }
            break;
      case 'coronel':
              var options = {
                  host: 'web.directemar.cl',
                  path: '/met/jturno/PRONOSTICOS/Cenmeteotalc/72/coronel72.txt'
                }
            break;
      case 'lebu':
              var options = {
                  host: 'web.directemar.cl',
                  path: '/met/jturno/PRONOSTICOS/Cenmeteotalc/72/lebu72.txt'
                }
            break;
      case 'saavedra':
              var options = {
                  host: 'web.directemar.cl',
                  path: '/met/jturno/PRONOSTICOS/Cenmeteotalc/72/saavedra72.txt'
                }
            break;
      case 'coronel':
              var options = {
                  host: 'web.directemar.cl',
                  path: '/met/jturno/PRONOSTICOS/Cenmeteotalc/72/corral72.txt'
                }
            break;
      case 'mehuin':
              var options = {
                  host: 'web.directemar.cl',
                  path: '/met/jturno/PRONOSTICOS/Cenmeteotalc/72/mehuin72.txt'
                }
            break;
//Centro Meteorológico de Puerto Montt
// =============================================================================
      case 'maullin':
              var options = {
                  host: 'web.directemar.cl',
                  path: '/met/jturno/PRONOSTICOS/Cenmeteopmo/72/maullin72.txt'
                }
              break;
      case 'chacao':
                var options = {
                    host: 'web.directemar.cl',
                    path: '/met/jturno/PRONOSTICOS/Cenmeteopmo/72/chacao72.txt'
                  }
              break;
      case 'pmontt':
                var options = {
                    host: 'web.directemar.cl',
                    path: '/met/jturno/PRONOSTICOS/Cenmeteopmo/72/pmontt72.txt'
                  }
              break;
      case 'guafo':
                var options = {
                    host: 'web.directemar.cl',
                    path: '/met/jturno/PRONOSTICOS/Cenmeteopmo/72/guafo72.txt'
                  }
              break;
      case 'chacabuco':
                var options = {
                    host: 'web.directemar.cl',
                    path: '/met/jturno/PRONOSTICOS/Cenmeteopmo/72/chacabuco72.txt'
                  }
              break;
      case 'chiloeoriental':
                var options = {
                    host: 'web.directemar.cl',
                    path: '/met/jturno/PRONOSTICOS/Cenmeteopmo/72/chiloeoriental72.txt'
                  }
              break;
      case 'penas':
                var options = {
                    host: 'web.directemar.cl',
                    path: '/met/jturno/PRONOSTICOS/Cenmeteopmo/72/penas72.txt'
                  }
              break;
//Centro Meteorológico de Punta Arenas
// =============================================================================
      case 'natales':
                var options = {
                    host: 'web.directemar.cl',
                    path: '/met/jturno/PRONOSTICOS/Cenmeteopar/72/natales72.txt'
                  }
              break;
      case 'parenas':
                  var options = {
                      host: 'web.directemar.cl',
                      path: '/met/jturno/PRONOSTICOS/Cenmeteopar/72/parenas72.txt'
                    }
                break;
      case 'williams':
                    var options = {
                        host: 'web.directemar.cl',
                        path: '/met/jturno/PRONOSTICOS/Cenmeteopar/72/williams72.txt'
                      }
                  break;
      case 'fildes':
                    var options = {
                        host: 'web.directemar.cl',
                        path: '/met/jturno/PRONOSTICOS/Cenmeteopar/72/fildes72.txt'
                      }
                  break;
      default:
          var options = '';
          break;
  }
  return options;
};

// Export detail da formato html a los valores del clima para cada ciudad.

exports.detail = function(data) {

  var tmpstr = JSON.stringify(data);

  for (i = 0; i < data.length; i++){

    ///saca espacion y saltos de linea
    tmpstr = tmpstr.replace(/"/g, '');
    tmpstr = tmpstr.replace('\"', " ");
    tmpstr = tmpstr.replace('\\t', " ");
    tmpstr = tmpstr.replace("\\r\\n", "<br>");
    tmpstr = tmpstr.replace("\uFFFD C", "<b> Grados C</b>.");
    tmpstr = tmpstr.replace("\uFFFDC.", "<b> Grados C</b>.");
    tmpstr = tmpstr.replace("D\uFFFDBIL.", "DEBIL.");

    //cambia estados de clima por imagenes
    tmpstr = tmpstr.replace("TEMPERATURA MINIMA PROBABLE:", "<img src='/api/public/img/tmin.png' width='5%'>");
    tmpstr = tmpstr.replace("TEMPERATURA MAXIMA PROBABLE:", "<img src='/api/public/img/tmax.png' width='5%'>");
    tmpstr = tmpstr.replace("TEMP. MAXIMA PROBABLE", "<img src='/api/public/img/tmax.png' width='5%'>");
    tmpstr = tmpstr.replace("TEMP. MINIMA PROBABLE", "<img src='/api/public/img/tmin.png' width='5%'>");

    //Cambios de formatos en el html
    tmpstr = tmpstr.replace("DIA ", "<hr><br>DIA_");
    tmpstr = tmpstr.replace("CU\uFFFDA", " CUNA");

  }
  //Inserta etiquetas div temp y p tmp para realizar la eliminacion.
  tmpstr = tmpstr.replace("---", "<div id='temp'><p id='tmp'>---");
  tmpstr = tmpstr.replace("BT", "BT</p></div>");
  tmpstr = tmpstr.replace("MET0", "<div id='temp'><p id='tmp'>MET0");
  tmpstr = tmpstr.replace("RB", "RB</p></div>");

  //
  tmpstr = tmpstr.replace("SITUACION SINOPTICA:", "<h4>SITUACION SINOPTICA:</h4>");
  tmpstr = tmpstr.replace("PRONOSTICO", "<b>PRONOSTICO</b>");
  //Cambios en el html de radiacion ULTRAVIOLETA
  tmpstr = tmpstr.replace("INDICE DE RADIACION ULTRAVIOLETA:", "<h4>INDICE DE RADIACION ULTRAVIOLETA:</h4>");
  tmpstr = tmpstr.replace("0-2 BAJO", "<style>mark {background-color: green;color: black;}</style><mark>0-2 BAJO - TME 60+'</mark>");
  tmpstr = tmpstr.replace("3-5 MODERADO", "<style>mark {background-color: yelow;color: black;}</style><mark>3-5 MODERADO - TME 45'</mark>");
  tmpstr = tmpstr.replace("6-7 ALTO", "<style>mark {background-color: orange;color: black;}</style><mark>6-7 ALTO - TME 30'</mark>");
  tmpstr = tmpstr.replace("8-10 MUY ALTO ", "<style>mark {background-color: red;color: black;}</style><mark>8-10 MUY ALTO - TME 25'</mark>");
  tmpstr = tmpstr.replace("11 O MAS EXTREMO", "<style>mark {background-color: purple;color: black;}</style><mark>11 O MAS EXTREMO - TME 10'</mark>");
  tmpstr = tmpstr.replace("(FUENTE DMC).", "<h5>(FUENTE DMC). TME: Tiempo Maximo Recomendado exposicion</h5>");

  //Cambios en el html de hora local

  var dataPattern = /\d+/g;
  var date = tmpstr.match( dataPattern )
  for (i=0; i<date.length; i++){
      if (date[i].length == 6){
        var day = date[i].charAt(0)+date[i].charAt(1);
        var hour = date[i].charAt(2)+date[i].charAt(3);
        var min = date[i].charAt(4)+date[i].charAt(5);
        tmpstr = tmpstr.replace(date[i], "<b>El dia "+ day + " a las "+ hour+":"+ min +"</b>");
    //console.log(date[i]);
      }
    }
   return tmpstr;

};
